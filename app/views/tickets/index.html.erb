<a role="button" href="/tickets/take" class="btn btn-default"> Take Next Available </a>

<h2>Open Tickets</h2>

<table class="table table-condensed table-striped">
  <thead>
    <tr>
      <th>Created at</th>
      <th>Updated at</th>
      <th>Uid</th>
      <th>Skill</th>
      <th>Served</th>
      <th>Progress</th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @tickets.each do |ticket| %>
      <tr>
        <td><%= time_ago_in_words(ticket.created_at) %></td>
        <td><%= time_ago_in_words(ticket.updated_at) %></td>
        <td><%= ticket.uid %></td>
        <td><%= ticket.skill %></td>
        <td><%= ticket.served %></td>
        <td><small><%= ticket.progress %></small></td>
        <td><%= link_to 'Take', action: 'take', id: ticket.id %></td>
        <td><%= link_to 'Destroy', ticket, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<script>

 // reload this page 
 var reloadTimer = setInterval(function() { window.location.reload(true); }, 5000);

 $(window).on('beforeunload', function() {
   clearTimeout(reloadTimer);
 });

</script>
